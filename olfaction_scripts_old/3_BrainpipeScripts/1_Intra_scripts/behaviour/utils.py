
import numpy as np



###################################################
x0,y0,z0 = 20, 30,-16 #VOI for olf OFC
x1,y1,z1 = -20, 32,-16 #VOI for olf OFC
x0_ins,y0_ins,z0_ins = 42.0, -7.3, 0.3 #VOI for olf Ins
x1_ins,y1_ins,z1_ins = -38, -4, 12 #VOI for olf Ins
rad = 11 #radius of the VOI
HC_lim = -26 #limit anterior/posterior part of the aHC
###################################################

def rename_elecs(names,x,y,z):

    labels = ['pPirT' if lab =='Amg-PirT' else lab for lab in names]

    labels = ['aHC' if lab == 'HC' and y[i] > -26 else lab \
                                  for i,lab in enumerate(labels)]

    id_R_OFC = [1 if all([x0-rad<round(x[i])<x0+rad, y0-rad<round(y[i])<y0+rad,
                    z0-rad<round(z[i])<z0+rad]) else 0 for i in range(len(labels))]
    id_L_OFC = [1 if all([x1-rad<round(x[i])<x1+rad, y1-rad<round(y[i])<y1+rad,
                    z1-rad<round(z[i])<z1+rad]) else 0 for i in range(len(labels))]
    idx_OFC = np.array(id_R_OFC) + np.array(id_L_OFC)
    labels = ['OFC_olf' if idx == 1 else labels[i] for i,idx in enumerate(idx_OFC)]

    id_R_ins = [1 if all([x0_ins-rad<=round(x[i])<=x0_ins+rad, y0_ins-rad<=round(y[i])<=y0_ins+rad,
                    z0_ins-rad<=round(z[i])<=z0_ins+rad]) else 0 for i in range(len(labels))]
    id_L_ins = [1 if all([x1_ins-rad<=round(x[i])<=x1_ins+rad, y1_ins-rad<=round(y[i])<=y1_ins+rad,
                    z1_ins-rad<=round(z[i])<=z1_ins+rad]) else 0 for i in range(len(labels))]
    idx_ins = np.array(id_R_ins) + np.array(id_L_ins)
    labels = ['Ins_olf' if i == 1 else lab for i,lab in zip(idx_ins,labels)]

    return np.array(labels)

def odors_su_score(scoring, meth):
    if scoring == 'Perf' and meth == 'wth':
            odors_su =  {'CHAF': {7:68,8:36,9:96,2:2,3:68},
                         'LEFC': {1:4,2:0,3:6,4:12,14:96,15:2,16:4,17:68},
                         'PIRJ': {4:36,9:2,1:4,18:32}, #15:4 remove for TPS, 6:34,5:4,7:68
                         'VACJ': {14:6,15:64,16:68,17:8,10:6,11:4,12:4,13:40},
                         'SEMC': {10:2,11:6,12:6,13:6,5:8,7:4,8:8,9:10},
                         'FERJ': {16:6,17:6,5:8,7:6,12:8,13:8,2:6,1:10}}
    if scoring == 'Rec' and meth == 'wth':
        odors_su = { 'LEFC': {16: 4.68, 1: 3.94, 2: 8.43, 3: 6.05, 4: 4.74, 17: 5.52, 14: 4.03, 15: 5.01},
                     'SEMC': {5: 9.1, 7: 6.08, 8: 9.11, 9: 6.62, 10: 7.76, 11: 8.53, 12: 9.99, 13: 4.17},
                     'PIRJ': {1: 4.48, 18: 5.89, 4: 5.75, 9: 5.79}, #5:
                     'FERJ': {16: 5.0, 1: 2.28, 2: 4.14, 17: 4.12, 5: 3.08, 7: 2.8, 12: 3.11, 13: 3.53},
                     'CHAF': {2: 6.7, 3: 4.89, 7: 4.67, 8: 4.45, 9: 5.94},
                     'VACJ': {16: 5.86, 17: 10.84, 10: 7.37, 11: 10.04, 12: 10.65, 13: 4.56, 14: 9.16, 15: 6.45}}
    if scoring == 'Epi' and meth == 'wth':
        odors_su = {'LEFC': {16: 4.92, 1: 6.82, 3: 8.02, 4: 8.41, 17: 6.79, 14: 5.35, 15: 12.41},
                    'SEMC': {5: 10.05, 7: 6.35, 8: 10.26, 9: 7.83, 10: 8.51, 11: 13.0, 12: 9.93, 13: 5.48},
                    'PIRJ': {1: 4.81, 18: 8.11, 4: 9.33,  9: 7.54,}, #
                    'FERJ': {16: 7.96, 1: 4.42, 2: 5.89, 17: 6.3, 5: 4.84, 7: 5.23, 12: 4.33, 13: 7.07},
                    'CHAF': {2: 9.27, 3: 6.42, 7: 5.82, 8: 6.08, 9: 7.77},
                    'VACJ': {16: 8.25, 17: 15.96, 10: 14.97, 11: 14.79, 12: 25.83, 13: 10.68, 14: 16.55, 15: 6.1}}
    if scoring == 'Perf' and meth == 'btw':
            odors_su =  {'CHAF': {5:12,7:68,8:36,9:96,1:6,2:2,3:68,4:8},
                         'LEFC': {1:4,2:0,3:6,4:12,14:96,15:2,16:4,17:68},
                         'PIRJ': {4:36,9:2,1:4,18:32,6:34,5:4,7:68}, #15:4 remove for TPS,
                         'VACJ': {14:6,15:64,16:68,17:8,10:6,11:4,12:4,13:40},
                         'SEMC': {10:2,11:6,12:6,13:6,5:8,7:4,8:8,9:10},
                         'FERJ': {16:6,17:6,5:8,7:6,12:8,13:8,2:6,1:10}}
    if scoring == 'Rec' and meth == 'btw':
        odors_su = { 'LEFC': {16: 4.68, 1: 3.94, 2: 8.43, 3: 6.05, 4: 4.74, 17: 5.52, 14: 4.03, 15: 5.01},
                     'SEMC': {5: 9.1, 7: 6.08, 8: 9.11, 9: 6.62, 10: 7.76, 11: 8.53, 12: 9.99, 13: 4.17},
                     'PIRJ': {1: 4.48, 18: 5.89, 4: 5.75, 9: 5.79,5:7.43, 6: 5.11, 7: 3.14}, #5:
                     'FERJ': {16: 5.0, 1: 2.28, 2: 4.14, 17: 4.12, 5: 3.08, 7: 2.8, 12: 3.11, 13: 3.53},
                     'CHAF': {1: 3.21, 2: 6.7, 3: 4.89, 4: 4.34, 5: 5.84, 7: 4.67, 8: 4.45, 9: 5.94},
                     'VACJ': {16: 5.86, 17: 10.84, 10: 7.37, 11: 10.04, 12: 10.65, 13: 4.56, 14: 9.16, 15: 6.45}}
    if scoring == 'Epi' and meth == 'btw':
        odors_su = {'LEFC': {16: 4.92, 1: 6.82, 3: 8.02, 4: 8.41, 17: 6.79, 14: 5.35, 15: 12.41},
                    'SEMC': {5: 10.05, 7: 6.35, 8: 10.26, 9: 7.83, 10: 8.51, 11: 13.0, 12: 9.93, 13: 5.48},
                    'PIRJ': {1: 4.81, 18: 8.11, 4: 9.33,  9: 7.54,5: 9.83, 6: 10.57, 7: 4.98,}, #
                    'FERJ': {16: 7.96, 1: 4.42, 2: 5.89, 17: 6.3, 5: 4.84, 7: 5.23, 12: 4.33, 13: 7.07},
                    'CHAF': {1: 4.39, 2: 9.27, 3: 6.42, 4: 6.26, 5: 7.96, 7: 5.82, 8: 6.08, 9: 7.77},
                    'VACJ': {16: 8.25, 17: 15.96, 10: 14.97, 11: 14.79, 12: 25.83, 13: 10.68, 14: 16.55, 15: 6.1}}
    return odors_su

su_odor_groups = {'CHAF' : {'low':['1','2','4','5'],
                              'high':['3','8','7','9']},
                    'VACJ' : {'low':['11','14','12','10'],
                              'high':['15','17','16','13']},
                    'SEMC' : {'low':['7','10','11','12','13'],
                              'high':['5','8','9']},
                    'PIRJ' : {'low':['1','9','5'],
                              'high':['4','6','7','18']},
                    'LEFC' : {'low':['15','2','1','16'],
                              'high':['14','3','4','17']},
                    'FERJ' : {'low':['7','2','16','17'],
                              'high':['12','1','5','13']},}

odor_groups_wgth = {'CHAF' : {'low':['1','2','4','5'],
                              'high':['3','8','7','9']},
                    'VACJ' : {'low':['11','14','12','10'],
                              'high':['15','17','16','13']},
                    'SEMC' : {'low':['7','10','11','12','13'],
                              'high':['5','8','9']},
                    'PIRJ' : {'low':['1','9','5'],
                              'high':['4','6','7','18']},
                    'LEFC' : {'low':['15','2','1','16'],
                              'high':['14','3','4','17']},
                    'FERJ' : {'low':['7','12','16','17'],
                              'high':['13','1','5','2']},}

odor_groups_3wgth = {'CHAF' : {'low':['1','2','4'],'mid':['5','8'],'high':['3','7','9']},
                   	'VACJ' : {'low':['10','11','14'],'mid':['12','17'],'high':['16','13','15']},
                   	'SEMC' : {'low':['10','7','13'],'mid':['11','12'],'high':['5','9','8']},
                   	'PIRJ' : {'low':['9','1','5'],'mid':['18','4'],'high':['6','7']},
                   	'LEFC' : {'low':['2','1','16'],'mid':['15','3'],'high':['4','17','14']},
                   	'FERJ' : {'low':['16','17','12'],'mid':['7','13'],'high':['5','2','1']},
                   }

odor_su_score = {
        'CHAF': {'2':0.667, '1':3.667, '4':4.667, '5':7.333, '8':19.333, '7':30.667, '3':44.667, '9':58.667},
        'LEFC': {'2':0.0, '1':1.667, '16':1.667, '15':2.0, '3':3.333, '4':7.333, '17':30.667, '14':58.667},
        'FERJ': {'16':2.333, '17':2.333, '12':3.333, '7':3.667, '13':4.333, '5':4.667, '2':5.0, '1':5.333},
        'VACJ': {'11':1.667, '14':3.667, '12':4.0, '10':4.333, '17':6.0, '16':30.667, '13':35.333, '15':42.667},
        'SEMC': {'10':1.0, '7':3.333, '11':4.0, '12':4.0, '13':4.333, '5':4.667, '8':5.667, '9':7.333},
        'PIRJ': {'9':1.167, '1':2.167, '15':9.333, '5':9.667, '18':11.667, '6':17.167, '4':20.667, '7':34.667}
                }


# odor_groups_3wgth = {	'CHAF' : {'low':['1','2'],'mid':['4','5','8','7'],'high':['3','9']},
#                     	'VACJ' : {'low':['11','14'],'mid':['10','12','17','16'],'high':['13','15']},
#                     	'SEMC' : {'low':['10','7'],'mid':['13','11','12','5'],'high':['9','8']},
#                     	'PIRJ' : {'low':['9','1'],'mid':['18','5','6'],'high':['4','7']},
#                     	'LEFC' : {'low':['2','1','16'],'mid':['15','3','4'],'high':['17','14']},
#                     	'FERJ' : {'low':['16','17'],'mid':['12','7','13','5'],'high':['2','1']},
#                     }

def odor_list_su(exp):
	if exp == 'Enc':
		odlist_su = {'CHAF': [7,8,9,2,3], #4,5,1 missing wth Encoding
            'LEFC': [1,2,3,4,14,15,16,17],
            'PIRJ': [4,9,1,18], #missing odor 15,6,5,7
            'VACJ': [14,15,16,17,10,11,12,13],
            'SEMC': [10,11,12,13,5,7,8,9],
            'FERJ': [16,17,5,7,12,13,2,1]}

	if exp != 'Enc':
		odlist_su = {'CHAF': [1,5,4,7,8,9,2,3], #4,5,1 missing wth Encoding
	        'LEFC': [1,2,3,4,14,15,16,17],
	        'PIRJ': [4,9,1,18,5,6,7], #missing odor 15,6,5,7
	        'VACJ': [14,15,16,17,10,11,12,13],
	        'SEMC': [10,11,12,13,5,7,8,9],
	        'FERJ': [16,17,5,7,12,13,2,1]}
	return odlist_su


odor_REC_RT_3wgth = {	'CHAF' : {'low':['2','5','9'],'mid':['4','8'],'high':['3','7','1']},
                    	'LEFC' : {'low':['2','3','17'],'mid':['4','16'],'high':['15','1','14']},
                    	'FERJ' : {'low':['16','17','2'],'mid':['12','13'],'high':['5','7','1']},
                    	'VACJ' : {'low':['12','11','17'],'mid':['14','10'],'high':['16','13','15']},
                    	'SEMC' : {'low':['10','11','5'],'mid':['8','12'],'high':['7','9','13']},
                    	'PIRJ' : {'low':['5','9'],'mid':['18','4'],'high':['1','6','7']},
                    }

odor_EPI_RT_3wgth = {	'CHAF' : {'low':['4','5','9'],'mid':['3','8'],'high':['2','7','1']},
                    	'LEFC' : {'low':['15','4','3'],'mid':['17','14'],'high':['16','1','2']},
                    	'FERJ' : {'low':['13','7','2'],'mid':['16','5'],'high':['12','17','1']},
                    	'VACJ' : {'low':['12','14','17'],'mid':['11','10'],'high':['16','13','15']},
                    	'SEMC' : {'low':['12','11','8'],'mid':['5','9'],'high':['7','10','13']},
                    	'PIRJ' : {'low':['6','5','4'],'mid':['18','9'],'high':['1','7']},
                    }

odor_REC_first_3wgth = {'CHAF' : {'low':['4','8','7'],'mid':['5','1'],'high':['3','9','2']},
                    	'LEFC' : {'low':['2','3','4'],'mid':['17','14'],'high':['16','15','1']},
                    	'FERJ' : {'low':['2','17','12'],'mid':['7','13'],'high':['16','5','1']},
                    	'VACJ' : {'low':['12','11','10'],'mid':['14','16'],'high':['17','13','15']},
                    	'SEMC' : {'low':['10','11','8'],'mid':['5','9'],'high':['7','12','13']},
                    	'PIRJ' : {'low':['5','9','18'],'mid':['6','1'],'high':['4','7']},
                    }

odor_EPI_first_3wgth = {'CHAF' : {'low':['4','5','8'],'mid':['7','1'],'high':['9','3','2']},
                    	'LEFC' : {'low':['2','15','4'],'mid':['17','3'],'high':['16','1','14']},
                    	'FERJ' : {'low':['13','7','2'],'mid':['1','5'],'high':['12','17','16']},
                    	'VACJ' : {'low':['12','14','17'],'mid':['11','10'],'high':['16','13','15']},
                    	'SEMC' : {'low':['5','11','8'],'mid':['12','7'],'high':['9','10','13']},
                    	'PIRJ' : {'low':['6','5','4'],'mid':['7','9'],'high':['1','18']},
                    }

pos_cirles = 	{'P1':[244,334],'P2':[162,597],
				 'P3':[755,519],'P4':[764,143],
				 'P5':[83,117],'P6':[395,158],
				 'P7':[401,640],'P8':[541,345],}

pos_dist_gr = {'P1': {'close': ['P2', 'P5', 'P6'],
					'far': ['P4', 'P3', 'P7', 'P8']},
				'P2': {'close': ['P5', 'P8', 'P7'],
					'far': ['P1', 'P4', 'P3', 'P6']},
				'P3': {'close': ['P4', 'P7', 'P8'],
					'far': ['P2', 'P1', 'P5', 'P6']},
				'P4': {'close': ['P7', 'P6', 'P8'],
					'far': ['P2', 'P1', 'P3', 'P5']},
				'P5': {'close': ['P7', 'P8', 'P6'],
					'far': ['P3', 'P4', 'P2', 'P1']},
				'P6': {'close': ['P1', 'P7', 'P8'],
					'far': ['P3', 'P2', 'P4', 'P5']},
				'P7': {'close': ['P1', 'P2', 'P8'],
					'far': ['P4', 'P5', 'P6', 'P3']},
				'P8': {'close': ['P1', 'P3', 'P6'],
					'far': ['P5', 'P2', 'P7', 'P4']}}

odor_exp = ["Musc","Rosemarel","Stémone","2-Héptanone","Carotte",
			"Butanol","Dihydromyrcénol","Salicylate_cis_3_hexanyl",
			"Octine_carbonate_de_méthyl","Citronellol","Birch_oil",
			"Acétate_linalyle","9_decen-1-ol","Tabac","Acétyl_acetate_d_éthyl",
			"Basilic_comores","Tomate","Oxyde de rose","Pamplemousse","Ebanol"]
